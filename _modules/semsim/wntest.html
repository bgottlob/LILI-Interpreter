

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>semsim.wntest &mdash; LILI Interpreter 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="LILI Interpreter 1.0 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> LILI Interpreter
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../wntest.html">wntest module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interpreter.html">interpreter module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interpreterdemo.html">interpreter module demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../interpreterdemo.html#initial-setup">Initial Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interpreterdemo.html#preprocessing-and-action-detection">Preprocessing and Action Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interpreterdemo.html#extracting-objects-from-the-command">Extracting Objects from the Command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../extractor.html">extractor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../terms.html">Terminology</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">LILI Interpreter</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>semsim.wntest</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for semsim.wntest</h1><div class="highlight"><pre>
<span class="c"># This code will be used to test WordNet&#39;s ability to match words based on semantic similarity</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">wordnet</span> <span class="k">as</span> <span class="n">wn</span>
<span class="kn">import</span> <span class="nn">csv</span>

<div class="viewcode-block" id="build_known_file"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.build_known_file">[docs]</a><span class="k">def</span> <span class="nf">build_known_file</span><span class="p">(</span><span class="n">known_words_filename</span><span class="p">,</span> <span class="n">unknown_words_filename</span><span class="p">,</span> <span class="n">synset_csv_filename</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c"># Build needed data structures</span>
    <span class="n">known_words_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">known_words_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>

    <span class="n">known_words_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">final_word_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># Process known words file to build the two structures</span>
    <span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">known_words_file</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="c"># Checks to make sure line isn&#39;t blank</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">known_words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
            <span class="c"># Checks to make sure there is at least one action to avoid exception</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">known_words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># Add the first action and its action set index to the dictionary to speed up lookups</span>
                <span class="c"># The second value in this tuple will be replaced by the correct synset when the synset file is processed</span>
                <span class="n">known_words_dict</span><span class="p">[</span><span class="n">known_words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_num</span><span class="p">,</span> <span class="s">&quot;synset not found&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">known_word</span> <span class="ow">in</span> <span class="n">known_words</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                    <span class="n">known_word</span> <span class="o">=</span> <span class="n">known_word</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="c"># Add each known word to the final word list - don&#39;t add the first known word in the line to this, since it is already stored in the dictionary</span>
                    <span class="n">final_word_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">known_word</span><span class="p">,</span> <span class="n">line_num</span><span class="p">))</span>
                <span class="n">line_num</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c"># Process the file of synsets</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">synset_csv_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">synset_file</span><span class="p">:</span>
        <span class="n">synset_file_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">synset_file</span><span class="p">)</span>
        <span class="c"># Assuming first line in CSV file is a header, so skip it</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">synset_file_reader</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">synset_file_reader</span><span class="p">:</span>
            <span class="c"># Change the known word tuple&#39;s synset value</span>
            <span class="n">known_words_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span><span class="n">known_words_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">unknown_words_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">unknown_words_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>

    <span class="c"># Process unknown words and map them to known ones</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">unknown_words_file</span><span class="p">:</span>
        <span class="n">unknown_word</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">unknown_word</span><span class="p">:</span>

            <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c"># If words are not semantically similar, this value will not be changed</span>
            <span class="n">max_unknown_synset</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">max_known_synset</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">known_choice</span> <span class="o">=</span> <span class="s">&quot;No match found&quot;</span>
            <span class="n">match_found</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="k">for</span> <span class="n">known</span><span class="p">,</span> <span class="n">known_tuple</span> <span class="ow">in</span> <span class="n">known_words_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>

                <span class="n">known_line_num</span> <span class="o">=</span> <span class="n">known_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">known_synset</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synset</span><span class="p">(</span><span class="n">known_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="c"># If the unknown word is a lemma of the known sysnset, then the unknown word is a synonym</span>
                <span class="k">if</span> <span class="n">unknown_word</span> <span class="ow">in</span> <span class="n">known_synset</span><span class="o">.</span><span class="n">lemma_names</span><span class="p">():</span>
                    <span class="n">sem_sim_score</span> <span class="o">=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">sem_sim_score</span> <span class="o">&gt;</span> <span class="n">max_sem_sim_score</span><span class="p">:</span>

                        <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="n">sem_sim_score</span>
                        <span class="n">match_line_num</span> <span class="o">=</span> <span class="n">known_line_num</span>
                        <span class="n">match_found</span> <span class="o">=</span> <span class="bp">True</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># Check if the pos argument has been provided</span>
                    <span class="k">if</span> <span class="s">&#39;pos&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;pos&#39;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span>

                    <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;verb&quot;</span><span class="p">:</span>
                        <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown_word</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">VERB</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;noun&quot;</span><span class="p">:</span>
                        <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown_word</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">NOUN</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;adj&quot;</span><span class="p">:</span>
                        <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown_word</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADJ</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;adv&quot;</span><span class="p">:</span>
                        <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown_word</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADV</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown_word</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">unknown_synset</span> <span class="ow">in</span> <span class="n">unknown_synsets</span><span class="p">:</span>

                        <span class="n">sem_sim_score</span> <span class="o">=</span> <span class="n">unknown_synset</span><span class="o">.</span><span class="n">path_similarity</span><span class="p">(</span><span class="n">known_synset</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">sem_sim_score</span> <span class="o">&gt;</span> <span class="n">max_sem_sim_score</span><span class="p">:</span>

                            <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="n">sem_sim_score</span>
                            <span class="n">match_line_num</span> <span class="o">=</span> <span class="n">known_line_num</span>
                            <span class="n">match_found</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="c"># If a match was found, then add the unknown word to the final word list</span>
            <span class="k">if</span> <span class="n">match_found</span><span class="p">:</span>
                <span class="n">final_word_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">unknown_word</span><span class="p">,</span> <span class="n">match_line_num</span><span class="p">))</span>


    <span class="c"># The final word list has been built, so put all matching words into the input file at specified lines</span>

    <span class="c"># Sort the final word list by line number, so each word can be written in sequence</span>
    <span class="n">final_word_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">final_word_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c"># Create a list of the actions that will be placed first in each line - these are the previously known words</span>
    <span class="n">first_word_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">known</span><span class="p">,</span> <span class="n">known_tuple</span> <span class="ow">in</span> <span class="n">known_words_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="n">first_word_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">known</span><span class="p">,</span> <span class="n">known_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">print</span> <span class="n">first_word_list</span>
    <span class="c"># Sort by the known word&#39;s line number and put only the actual word into the first action list</span>
    <span class="n">first_word_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k_tup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">first_word_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">print</span> <span class="n">first_word_list</span>

    <span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
    <span class="n">current_line</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">word_tuple</span> <span class="ow">in</span> <span class="n">final_word_list</span><span class="p">:</span>
        <span class="c"># Whenever the current line is not the line that the current word needs to go in, start a new line with the appropriate first word</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">current_line</span> <span class="o">==</span> <span class="n">word_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="c"># Must write to a new line</span>
            <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c"># Start a new line if this isn&#39;t the first line of the file</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">current_line</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="c"># Write the known action to be the first action of the line</span>
            <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">first_word_list</span><span class="p">[</span><span class="n">current_line</span><span class="p">])</span>

        <span class="c"># Now that the current line is the line the current word needs to go on, write the current word</span>
        <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;,&quot;</span> <span class="o">+</span> <span class="n">word_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="sem_sim_test2"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.sem_sim_test2">[docs]</a><span class="k">def</span> <span class="nf">sem_sim_test2</span><span class="p">(</span><span class="n">known_words_filename</span><span class="p">,</span> <span class="n">unknown_words_filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests semantic similarity mapping from unknown words to known words. Synsets of the unknown words are not known in advance and those of the known words are determined in advance.</span>

<span class="sd">    Accepts a CSV file of known words paired with their assumed WordNet synset and a text file of unknown words (with one word per line). Each unknown word is matched up with the known word that it is most semantically similar to. &quot;Known&quot; words are words that LILI has been preprogrammed to recognize or respond to in some way, while &quot;unknown&quot; words are those that LILI does not understand by default. Semantic similarity measures are made using WordNet and attempt to allow LILI to understand an open vocabulary beyond the words and phrases it has been preprogrammed to respond to. This test returns a list of :class:`~semsim.wntest.SemanticSimilarityResult` objects to store the results of the test for each unknown word.</span>

<span class="sd">    Args:</span>
<span class="sd">        known_words_filename (str): The filename of the CSV file containing known words paired with their assumed synsets</span>
<span class="sd">        unknown_words_filename (str): The filename of the text file containing unknown words</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        pos (str): The part of speech of the words to be evaluated. Can have the values &quot;verb&quot;, &quot;noun&quot;, &quot;adj&quot;, or &quot;adv&quot;. If neither of these values are used or no value is provided, searching the synsets of the unknown word will not be filtered by part of speech, resulting in more processing time and potentially less accurate results</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The sorted list of :class:`~wntest.SemanticSimilarityResult` objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Start an empty list of results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># Start an empty list of known verbs</span>
    <span class="n">known_words</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># Open the CSV file of known words and read contents</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">known_words_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">known_words_file</span><span class="p">:</span>
        <span class="n">known_word_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">known_words_file</span><span class="p">)</span>
        <span class="c"># Assuming first line in CSV file is a header</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">known_word_reader</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">known_word_reader</span><span class="p">:</span>
            <span class="c"># Add to the list of known verbs</span>
            <span class="n">known_words</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c"># Open the file of unknown words and begin processing</span>
    <span class="n">unknown_words_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">unknown_words_filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">unknown_words_file</span><span class="p">:</span>

        <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c"># If words are not semantically similar, this value will not be changed</span>
        <span class="n">max_unknown_synset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">max_known_synset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">known_choice</span> <span class="o">=</span> <span class="s">&quot;No match found&quot;</span>
        <span class="n">match_found</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">unknown</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">known_tuple</span> <span class="ow">in</span> <span class="n">known_words</span><span class="p">:</span>

            <span class="n">known</span> <span class="o">=</span> <span class="n">known_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">known_synset</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synset</span><span class="p">(</span><span class="n">known_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">known_synset</span><span class="o">.</span><span class="n">lemma_names</span><span class="p">():</span>
                <span class="n">sem_sim_score</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">sem_sim_score</span> <span class="o">&gt;</span> <span class="n">max_sem_sim_score</span><span class="p">:</span>

                    <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="n">sem_sim_score</span>
                    <span class="n">max_unknown_synset</span> <span class="o">=</span> <span class="n">unknown_synset</span>
                    <span class="n">max_known_synset</span> <span class="o">=</span> <span class="n">known_synset</span>
                    <span class="n">known_choice</span> <span class="o">=</span> <span class="n">known</span>
                    <span class="n">match_found</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Check if the pos argument has been provided</span>
                <span class="k">if</span> <span class="s">&#39;pos&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;pos&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span>

                <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;verb&quot;</span><span class="p">:</span>
                    <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">VERB</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;noun&quot;</span><span class="p">:</span>
                    <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">NOUN</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;adj&quot;</span><span class="p">:</span>
                    <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADJ</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;adv&quot;</span><span class="p">:</span>
                    <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">wn</span><span class="o">.</span><span class="n">ADV</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">unknown_synsets</span> <span class="o">=</span> <span class="n">wn</span><span class="o">.</span><span class="n">synsets</span><span class="p">(</span><span class="n">unknown</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">unknown_synset</span> <span class="ow">in</span> <span class="n">unknown_synsets</span><span class="p">:</span>

                    <span class="n">sem_sim_score</span> <span class="o">=</span> <span class="n">unknown_synset</span><span class="o">.</span><span class="n">path_similarity</span><span class="p">(</span><span class="n">known_synset</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">sem_sim_score</span> <span class="o">&gt;</span> <span class="n">max_sem_sim_score</span><span class="p">:</span>

                        <span class="n">max_sem_sim_score</span> <span class="o">=</span> <span class="n">sem_sim_score</span>
                        <span class="n">max_unknown_synset</span> <span class="o">=</span> <span class="n">unknown_synset</span>
                        <span class="n">max_known_synset</span> <span class="o">=</span> <span class="n">known_synset</span>
                        <span class="n">known_choice</span> <span class="o">=</span> <span class="n">known</span>
                        <span class="n">match_found</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="n">match_found</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SemanticSimilarityResult</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">known_choice</span><span class="p">,</span> <span class="n">max_unknown_synset</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">max_known_synset</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">max_unknown_synset</span><span class="o">.</span><span class="n">definition</span><span class="p">(),</span> <span class="n">max_known_synset</span><span class="o">.</span><span class="n">definition</span><span class="p">(),</span> <span class="n">max_sem_sim_score</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SemanticSimilarityResult</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span><span class="s">&quot;No match found&quot;</span><span class="p">,</span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="n">max_sem_sim_score</span><span class="p">))</span>

        <span class="k">print</span> <span class="p">(</span><span class="s">&quot;Finished processing &quot;</span> <span class="o">+</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</div>
<div class="viewcode-block" id="process_results"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.process_results">[docs]</a><span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="n">results_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts a list of :class:`~wntest.SemanticSimilarityResult` objects in descsending order by semantic similarity score</span>

<span class="sd">    Args:</span>
<span class="sd">        results_list (list): The list of :class:`~wntest.SemanticSimilarityResult` objects to be sorted</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The sorted list of :class:`~wntest.SemanticSimilarityResult` objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">res</span><span class="p">:</span><span class="n">res</span><span class="o">.</span><span class="n">sem_sim_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="output_results"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.output_results">[docs]</a><span class="k">def</span> <span class="nf">output_results</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the given list of :class:`~wntest.SemanticSimilarityResult` objects to a CSV file</span>

<span class="sd">    Given a list of :class:`~wntest.SemanticSimilarityResult` objects and a .csv filename, writes the values of the result objects to specified file.</span>

<span class="sd">    Args:</span>
<span class="sd">        results_list (list): The list of :class:`~wntest.SemanticSimilarityResult` objects to be printed to the CSV file</span>
<span class="sd">        output_filename (str): The name of the CSV file to be written to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Open the output file for writing</span>
    <span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
    <span class="n">out_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>

    <span class="c"># Writes a header to the output file</span>
    <span class="n">out_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">((</span><span class="s">&quot;unknown&quot;</span><span class="p">,</span><span class="s">&quot;known&quot;</span><span class="p">,</span><span class="s">&quot;unknown_synset&quot;</span><span class="p">,</span><span class="s">&quot;known_synset&quot;</span><span class="p">,</span><span class="s">&quot;unknown_definition&quot;</span><span class="p">,</span><span class="s">&quot;known_definition&quot;</span><span class="p">,</span><span class="s">&quot;semantic_similarity_score&quot;</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results_list</span><span class="p">:</span>
        <span class="n">out_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">((</span><span class="n">res</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">known</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">unknown_synset</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">known_synset</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">unknown_definition</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">known_definition</span><span class="p">,</span>
        <span class="n">res</span><span class="o">.</span><span class="n">sem_sim_score</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="filter_results"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.filter_results">[docs]</a><span class="k">def</span> <span class="nf">filter_results</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a filtered list of the results of the given list based on the given semantic similarity score threshold</span>

<span class="sd">    Given a list of :class:`~SemanticSimilarityResult` objects and a threshold value, filters the list removing result objects with semantic similarity scores less than the threshold. Returns the filtered list.</span>

<span class="sd">    Args:</span>
<span class="sd">        results_list (list): The list of :class:`~SemanticSimilarityResult` objects to be filtered</span>
<span class="sd">        threshold (number): The semantic similarity score threshold at which results with a score lower than this threshold will be removed from C{results_list}</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The filtered list of C{SemanticSimilarityResult} objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results_list</span> <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">sem_sim_score</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="SemanticSimilarityResult"><a class="viewcode-back" href="../../wntest.html#semsim.wntest.SemanticSimilarityResult">[docs]</a><span class="k">class</span> <span class="nc">SemanticSimilarityResult</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; This class is used to package results from semantic similarity tests. Each object of this class holds the result of a single unknown to known word mapping.</span>

<span class="sd">    This class stores a variety of information for analysis purposes, including the synsets with the highest similarity score, their definitions, the semantic similarity score, and most importantly the known word that the unknown word will map to. This class is to be used for testing and analysis purposes to see how the semantic similarity measure may be improved. The only pieces of information important to the final result of the LILI interpreter is the known word that the unknown word is mapped to.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        unknown (str): The unknown word that has been mapped to a known word</span>
<span class="sd">        known (str): The known word that has been mapped to</span>
<span class="sd">        unknown_synset (wn.Synset): The synset of the unknown word</span>
<span class="sd">        known_synset (wn.Synset): The synset of the known word that has been mapped to</span>
<span class="sd">        unknown_defintion (str): The definition of unknown_synset</span>
<span class="sd">        known_definition (str): The definition of known_synset</span>
<span class="sd">        sem_sim_score (number): The semantic similarity score between unknown_synset and known_synset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">known</span><span class="p">,</span> <span class="n">unknown_synset</span><span class="p">,</span> <span class="n">known_synset</span><span class="p">,</span> <span class="n">unknown_definition</span><span class="p">,</span> <span class="n">known_definition</span><span class="p">,</span> <span class="n">sem_sim_score</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Constructor for the :class:`wntest.SemanticSimilarityResult` class. See the class&#39;s documentation for details on each parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="n">unknown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known</span> <span class="o">=</span> <span class="n">known</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown_synset</span> <span class="o">=</span> <span class="n">unknown_synset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_synset</span> <span class="o">=</span> <span class="n">known_synset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown_definition</span> <span class="o">=</span> <span class="n">unknown_definition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_definition</span> <span class="o">=</span> <span class="n">known_definition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sem_sim_score</span> <span class="o">=</span> <span class="n">sem_sim_score</span></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Brandon Gottlob.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>